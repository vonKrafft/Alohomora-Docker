<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="../static/bootstrap.min.css"/>

    <title>Alohomora</title>
</head>
<body>

    <main class="container">

        <div class="row my-3">
            <div class="col-12 col-md-10 offset-md-1 col-lg-8 offset-lg-2">
                <nav class="nav nav-pills flex-row flex-nowrap">
                    <svg aria-hidden="true" focusable="false" viewBox="0 0 512 512" height="40" width="40" class="nav-link p-0"><path fill="currentColor" d="M63.8 409.3l60.5-59c32.1 42.8 71.1 66 126.6 67.4 30.5.7 60.3-7 86.4-22.4 5.1 5.3 18.5 19.5 20.9 22-32.2 20.7-69.6 31.1-108.1 30.2-43.3-1.1-84.6-16.7-117.7-44.4.3-.6-38.2 37.5-38.6 37.9 9.5 29.8-13.1 62.4-46.3 62.4C20.7 503.3 0 481.7 0 454.9c0-34.3 33.1-56.6 63.8-45.6zm354.9-252.4c19.1 31.3 29.6 67.4 28.7 104-1.1 44.8-19 87.5-48.6 121 .3.3 23.8 25.2 24.1 25.5 9.6-1.3 19.2 2 25.9 9.1 11.3 12 10.9 30.9-1.1 42.4-12 11.3-30.9 10.9-42.4-1.1-6.7-7-9.4-16.8-7.6-26.3-24.9-26.6-44.4-47.2-44.4-47.2 42.7-34.1 63.3-79.6 64.4-124.2.7-28.9-7.2-57.2-21.1-82.2l22.1-21zM104 53.1c6.7 7 9.4 16.8 7.6 26.3l45.9 48.1c-4.7 3.8-13.3 10.4-22.8 21.3-25.4 28.5-39.6 64.8-40.7 102.9-.7 28.9 6.1 57.2 20 82.4l-22 21.5C72.7 324 63.1 287.9 64.2 250.9c1-44.6 18.3-87.6 47.5-121.1l-25.3-26.4c-9.6 1.3-19.2-2-25.9-9.1-11.3-12-10.9-30.9 1.1-42.4C73.5 40.7 92.2 41 104 53.1zM464.9 8c26 0 47.1 22.4 47.1 48.3S490.9 104 464.9 104c-6.3.1-14-1.1-15.9-1.8l-62.9 59.7c-32.7-43.6-76.7-65.9-126.9-67.2-30.5-.7-60.3 6.8-86.2 22.4l-21.1-22C184.1 74.3 221.5 64 260 64.9c43.3 1.1 84.6 16.7 117.7 44.6l41.1-38.6c-1.5-4.7-2.2-9.6-2.2-14.5C416.5 29.7 438.9 8 464.9 8zM256.7 113.4c5.5 0 10.9.4 16.4 1.1 78.1 9.8 133.4 81.1 123.8 159.1-9.8 78.1-81.1 133.4-159.1 123.8-78.1-9.8-133.4-81.1-123.8-159.2 9.3-72.4 70.1-124.6 142.7-124.8zm-59 119.4c.6 22.7 12.2 41.8 32.4 52.2l-11 51.7h73.7l-11-51.7c20.1-10.9 32.1-29 32.4-52.2-.4-32.8-25.8-57.5-58.3-58.3-32.1.8-57.3 24.8-58.2 58.3zM256 160"></path></svg>
                    <h1 class="flex-grow-1 nav-link h5 my-0 font-weight-bold">Alohomora</h1>
                    <a class="btn btn-light ml-2 text-nowrap d-none d-sm-block" href="/allow.conf"><svg aria-hidden="true" focusable="false" viewBox="0 0 384 512" height="16" width="16"><path fill="currentColor" d="M280 240H168c-4.4 0-8 3.6-8 8v16c0 4.4 3.6 8 8 8h112c4.4 0 8-3.6 8-8v-16c0-4.4-3.6-8-8-8zm0 96H168c-4.4 0-8 3.6-8 8v16c0 4.4 3.6 8 8 8h112c4.4 0 8-3.6 8-8v-16c0-4.4-3.6-8-8-8zM112 232c-13.3 0-24 10.7-24 24s10.7 24 24 24 24-10.7 24-24-10.7-24-24-24zm0 96c-13.3 0-24 10.7-24 24s10.7 24 24 24 24-10.7 24-24-10.7-24-24-24zM336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM192 48c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm144 408c0 4.4-3.6 8-8 8H56c-4.4 0-8-3.6-8-8V120c0-4.4 3.6-8 8-8h40v32c0 8.8 7.2 16 16 16h160c8.8 0 16-7.2 16-16v-32h40c4.4 0 8 3.6 8 8v336z" class=""></path></svg> Display list</a>
                    <a class="btn btn-light ml-2 text-nowrap d-none d-sm-block" href="/allow.conf?dl=1"><svg aria-hidden="true" focusable="false" viewBox="0 0 576 512" height="16" width="16"><path fill="currentColor" d="M528 288h-92.1l46.1-46.1c30.1-30.1 8.8-81.9-33.9-81.9h-64V48c0-26.5-21.5-48-48-48h-96c-26.5 0-48 21.5-48 48v112h-64c-42.6 0-64.2 51.7-33.9 81.9l46.1 46.1H48c-26.5 0-48 21.5-48 48v128c0 26.5 21.5 48 48 48h480c26.5 0 48-21.5 48-48V336c0-26.5-21.5-48-48-48zm-400-80h112V48h96v160h112L288 368 128 208zm400 256H48V336h140.1l65.9 65.9c18.8 18.8 49.1 18.7 67.9 0l65.9-65.9H528v128zm-88-64c0-13.3 10.7-24 24-24s24 10.7 24 24-10.7 24-24 24-24-10.7-24-24z" class=""></path></svg> Download list</a>
                </nav>
            </div>
        </div>

        <div class="row my-3">
            <div class="col-12 col-md-10 offset-md-1 col-lg-8 offset-lg-2">
                <form role="form" action="/add" method="POST" class="my-0">
                    <div class="form-row">
                        <div class="form-group col">
                            <input type="text" class="form-control" placeholder="IP address" name="ip" value="{{ current_ip }}" autofocus="autofocus">
                        </div>
                        <div class="form-group col">
                            <input type="text" class="form-control" placeholder="Label" name="label">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-4 col-lg-2">
                            <input type="submit" class="btn btn-secondary btn-block" name="expiration" value="1 hour">
                        </div>
                        <div class="form-group col-4 col-lg-2">
                            <input type="submit" class="btn btn-secondary btn-block" name="expiration" value="12 hours">
                        </div>
                        <div class="form-group col-4 col-lg-2">
                            <input type="submit" class="btn btn-secondary btn-block" name="expiration" value="1 day">
                        </div>
                        <div class="form-group col-4 col-lg-2">
                            <input type="submit" class="btn btn-secondary btn-block" name="expiration" value="5 days">
                        </div>
                        <div class="form-group col-4 col-lg-2">
                            <input type="submit" class="btn btn-secondary btn-block" name="expiration" value="1 week">
                        </div>
                        <div class="form-group col-4 col-lg-2">
                            <input type="submit" class="btn btn-dark btn-block" name="expiration" value="Forever" default>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <div class="row my-3">
            <div class="col-12 col-md-10 offset-md-1 col-lg-8 offset-lg-2">
                <div class="card table-responsive">
                    <table class="table table-sm table-hover m-0">
                        <thead>
                            <tr>
                                <th class="text-nowrap">White-listed IP addresses</th>
                                <th class="d-none d-sm-table-cell">Label</th>
                                <th class="text-nowrap">Expire after</th>
                                <th>&nbsp;</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for entry in white_list %}
                            <tr>
                                <td class="align-middle"><small class="text-monospace">{{ entry.ip }}</small></td>
                                <td class="align-middle d-none d-sm-table-cell">{% if entry.label %}<span class="text-muted">{{ entry.label }}</span>{% endif %}</td>
                                <td class="align-middle">
                                    {% if entry.expiration == 0 %}
                                    <span class="badge badge-dark">Permanent</span>
                                    {% else %}
                                    <span class="badge badge-info">{{ entry.expiration - current_time }}s</span>
                                    {% endif %}
                                </td>
                                <td class="align-middle text-right"><a href="/delete/{{ entry.id }}" class="close"><span aria-hidden="true">&times;</span></a></td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="row my-3">
            <div class="col-12 col-md-10 offset-md-1 col-lg-8 offset-lg-2">
                <footer class="text-center">
                    <small><a href="https://github.com/vonKrafft/Alohomora-Docker" class="text-secondary">Source code <svg aria-hidden="true" focusable="false" viewBox="0 0 496 512" height="15" width="15"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></small>
                </footer>
            </div>
        </div>

    </main>

    <script type="text/javascript">
        var counter = setInterval(function() {
            var badges = document.getElementsByClassName('badge-info');
            for (var i = 0; i < badges.length; ++i) {
                var timer = parseInt(badges[i].innerHTML.replace(/[^0-9-]+/, '')) || 0;
                if (timer > 0) {
                    badges[i].innerHTML = (timer - 1) + 's';
                } else {
                    badges[i].innerHTML = 'Expired';
                    badges[i].classList.add('badge-danger');
                    badges[i].classList.remove('badge-info');
                }
            }
        }, 1000);
    </script>

</body>
</html>